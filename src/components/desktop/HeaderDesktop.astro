---
const path = Astro.url.pathname;
const isActive = (href) =>
  href === "/" ? path === "/" : path === href || path.startsWith(href);
---

<div class="flex items-center justify-between h-20 gap-8">

  <!-- Logo + Title/Slogan -->
  <div class="flex items-center gap-3">
    <a href="/" class="flex-shrink-0" aria-label="The Life Place — Home">
      <img src="/logo.png" alt="The Life Place Logo" class="h-16 w-auto" />
    </a>
    <div class="min-w-0">
      <a href="/" class="block font-bold text-2xl text-brand-red leading-tight">
        The Life Place
      </a>
      <span class="block text-sm text-center text-warmgray-600">
        Come. See. Jesus
      </span>
    </div>
  </div>

  <!-- Desktop nav -->
  <nav class="hidden md:flex items-center gap-6 font-montserrat text-sm md:text-base lg:text-lg ml-auto">
    <!-- What to Expect -->
    <a href="/what-to-expect/"
       class={`relative px-2 py-2 after:absolute after:left-0 after:-bottom-0.5 after:h-[2px] after:bg-brand-red after:w-0 hover:after:w-full after:transition-all ${isActive("/what-to-expect/") ? "text-brand-red after:w-full font-semibold" : "text-brand-darkgray hover:text-brand-red"}`}>
      What to Expect
    </a>

    <!-- About Us (dropdown) -->
    <!-- === ABOUT US (desktop) — replace this whole block === -->
<div
  id="dd-about"
  class="relative group focus-within:z-50"
>
  <button
    type="button"
    class={`relative px-2 py-2
            after:absolute after:left-0 after:-bottom-0.5 after:h-[2px] after:bg-brand-red
            after:w-0 group-hover:after:w-full after:transition-all after:duration-300
            ${isActive("/about-us/") 
              ? "text-brand-red after:w-full font-semibold" 
              : "text-warmgray group-hover:text-brand-red"}`}
    aria-haspopup="true"
    aria-expanded="false"
  >
    About Us
  </button>

  <div
    data-menu
    class="absolute left-0 top-full mt-1 w-56 rounded-md border bg-white shadow-lg z-50
           hidden group-hover:block focus-within:block pt-1"
    role="menu"
    aria-label="About Us Menu"
  >
    <a
      <a
  href="/about-us/our-mission"
  class="underline-anim px-4 py-2 text-sm text-brand-darkgray hover:text-brand-red after:bottom-[-0px]"
>
  Our Mission
</a>

    <a
  href="/about-us/our-values"
  class="underline-anim px-4 py-2 text-sm text-brand-darkgray hover:text-brand-red after:bottom-[-0px]"
>
  Our Values
</a>

    <a
  href="/about-us/leadership"
  class="underline-anim px-4 py-2 text-sm text-brand-darkgray hover:text-brand-red after:bottom-[-0px]"
>
  Meet Our Pastors
</a>
  </div>
</div>


            <div id="dd-give" class="relative group">
  <button
    type="button"
    className={`nav-underline px-2 py-2 whitespace-nowrap
                ? "text-brand-red after:w-full font-semibold" 
              : "text-warmgray-700 group-hover:text-brand-red"}`}
    aria-haspopup="true"
    aria-expanded="false"
  >Generosity
  </button>
</div>



<!-- Ministries dropdown -->
          <div id="dd-ministries" class="relative group">
            <button
              type="button"
              class={`relative px-2 py-2 whitespace-nowrap after:absolute after:left-0 after:-bottom-0.5 after:h-[2px] after:bg-brand-red after:w-0 group-hover:after:w-full after:transition-all after:duration-300
                      ${isActive("/ministries/") ? "text-brand-red after:w-full font-semibold" : "text-brand-warmgray group-hover:text-brand-red"}`}
              aria-haspopup="true" aria-expanded="false">
              Ministries
            </button>

            <div data-menu
              class="absolute left-0 top-full mt-1 w-64 rounded-md border bg-white shadow-lg z-50 hidden group-hover:block focus-within:block pt-1"
              role="menu" aria-label="Ministries Menu"
            >
              <!-- Onboarding -->
              <a href="/ministries/new-members/" 
              class="underline-anim px-4 py-2 text-sm text-warmgray-700 hover:text-brand-red after:bottom-[-0px]">New @The Life Place</a>

              <!-- Family -->
              <div class="px-3 pt-2 pb-1 text-[11px] uppercase tracking-wide text-warmgray-400">Family</div>
              <a href="/ministries/kids/" 
              class="underline-anim px-4 py-2 text-sm text-warmgray-700 hover:text-brand-red after:bottom-[-0px]">Kids @The Life Place</a>
              <a href="/ministries/child-dedication/"
              class="underline-anim px-4 py-2 text-sm text-warmgray-700 hover:text-brand-red after:bottom-[-0px]">Child Dedication Cohort</a>
              <a href="/ministries/premarital-counseling/" 
              class="underline-anim px-4 py-2 text-sm text-warmgray-700 hover:text-brand-red after:bottom-[-0px]">Premarital Counseling</a>

              <!-- Formation -->
              <div class="px-3 pt-2 pb-1 text-[11px] uppercase tracking-wide text-warmgray-400">Formation</div>
              <a href="/ministries/institute/"             
              class="underline-anim px-4 py-2 text-sm text-warmgray-700 hover:text-brand-red after:bottom-[-0px]" >The Life Place Institute</a>
              <a href="/ministries/faith-and-work/"        
              class="underline-anim px-4 py-2 text-sm text-warmgray-700 hover:text-brand-red after:bottom-[-0px]">Faith &amp; Work</a>

              <!-- Outreach -->
              <div class="px-3 pt-2 pb-1 text-[11px] uppercase tracking-wide text-warmgray-400">Outreach</div>
              <a href="/ministries/relief-center/"         
              class="underline-anim px-4 py-2 text-sm text-warmgray-700 hover:text-brand-red after:bottom-[-0px]">Relief Center</a>
            </div>
          </div>

<!-- Sticky dropdown behavior (prevent flicker) -->
<script is:inline>
  function stickyDropdown(id){
    const root=document.getElementById(id);
    if(!root) return;
    const menu=root.querySelector("[data-menu]");
    if(!menu) return;
    let t;
    const show=()=>{ clearTimeout(t); menu.classList.remove("hidden"); };
    const hide=()=>{ t=setTimeout(()=>menu.classList.add("hidden"),220); };
    root.addEventListener("mouseenter",show);
    root.addEventListener("mouseleave",hide);
    root.addEventListener("focusin",show);
    root.addEventListener("focusout",hide);
  }
  stickyDropdown("dd-about-desktop");
  stickyDropdown("dd-ministries-desktop");
</script>